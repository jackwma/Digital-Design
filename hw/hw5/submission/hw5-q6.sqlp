/* Wenjie Ma CSE 414
   Dan Suciu 
   Homework 5 Problem 6 */

use hw5;
select c.`-car_code` as country_code, c.name as country_name, mountArray as mountains
from world as w, w.mondial.country as c
let mountArray = (select m.name as mountian, m.height as mountain_height 
	from w.mondial.mountain as m, split(m.`-country`, ' ') as s 
	where c.`-car_code` = s)
order by array_count(mountArray) desc;

--Duration of all jobs: 4.831 sec
