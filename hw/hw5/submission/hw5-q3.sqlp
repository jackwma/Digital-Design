/* Wenjie Ma CSE 414
   Dan Suciu 
   Homework 5 Problem 3 */

use hw5;
select r.`#text` as religion, count(r) as num_countries
from world as w, w.mondial.country as c, 
	case when c.religions is missing then []
	when is_array(c.religions) then c.religions
	else [c.religions] end as r
group by r.`#text`
order by count(r) desc;

--Duration of all jobs: 0.621 sec

