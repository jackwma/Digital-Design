//Wenjie Ma, CSE 414 HW4
//Part 1, problem 1

WITH table AS 
(SELECT PC1.p1 AS p1, count(*) AS y
 FROM person_living AS PL, parent_child AS PC1, parent_child AS PC2
 WHERE PL.x = PC1.p1 AND PC1.p2 = PC2.p1
 GROUP BY PC1.p1, PC2.p3, count(*))
SELECT T.p1, MAX(y) AS z
FROM table AS T
GROUP BY T.p1, MAX(y);
